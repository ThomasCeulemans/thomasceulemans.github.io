function downSize(e){e.style.opacity=0;let{fontSize:t}=getComputedStyle(e);t=parseFloat(t);const o=document.createElement("span");for(o.innerText=".",e.append(o);t>9&&!o.isVisibleIn(e);)t-=.2,e.style.fontSize=`${t}px`;o.remove(),e.style.opacity=1}function initArticleSize(){document.querySelectorAll(".expandable-article").forEach(e=>{const{top:t,width:o,height:s,left:n}=e.getBoundingClientRect();e.style.setProperty("--top",t+"px"),e.style.setProperty("--width",o+"px"),e.style.setProperty("--height",s+"px"),e.style.setProperty("--left",n+"px")})}function pageReady(){customElements.define("mathjax-latex",class extends HTMLElement{constructor(){super(),MathJax.startup.output.clearCache(),this.innerHTML=MathJax.tex2chtml(this.textContent).innerHTML,this.prepend(MathJax.chtmlStylesheet()),this.classList.remove("rendering-latex","icon-latex")}})}document.body.addEventListener("keydown",e=>{const t=document.body;"Escape"===e.code&&(t.classList.contains("light-box-open")?(document.getElementById("light-box").remove(),t.classList.remove("light-box-open")):t.classList.contains("pdf-frame-open")?(document.getElementById("pdf-frame").remove(),t.classList.remove("pdf-frame-open")):t.classList.contains("popup-open")&&closeArticle())}),downSize(document.getElementById("poster-header-title")),initArticleSize(),window.addEventListener("resize",initArticleSize);class lightBox extends HTMLElement{constructor(e){super(),this.id="light-box",this.className="overlay overlay-light-box icon-cancel";const t=80,o=new Image;let s,n;o.src=e,this.append(o),o.addEventListener("load",()=>{s=o.width>o.height?"width":"height",n=s.replace(/[w|h]/,e=>e.toUpperCase()),this.original=o[s],"width"===(s=Math.min(window[`inner${n}`]-t,o[s]))?o.style.width=`${s}px`:o.style.height=`${s}px`,this.style.display="grid",document.body.append(this),document.body.classList.add("light-box-open")}),o.addEventListener("click",e=>{"width"===(s=e.shiftKey?Math.max(Math.min(this.original,window[`inner${n}`]-t),.9*s):Math.min(this.original,1.1*s))?o.style.width=`${s}px`:o.style.height=`${s}px`}),this.addEventListener("click",e=>{e.target!==o&&this.remove()})}}customElements.define("light-box",lightBox),[...document.getElementsByClassName("light-box-enable")].forEach(e=>{e.addEventListener("click",()=>{document.body.classList.contains("popup-open")&&new lightBox(e.src)})}),MathJax={startup:{pageReady:()=>{pageReady(),MathJax.typeset()}}},document.querySelectorAll(".article-narration-icon").forEach(e=>{const t=e.querySelector("audio"),o=e.dataset.id,s=document.getElementById(`player-${o}`),n=document.getElementById(`player-action-${o}`),a=document.getElementById(`player-current-${o}`),r=document.getElementById(`player-duration-${o}`),i=document.getElementById(`player-progress-${o}`);t.addEventListener("loadeddata",()=>{r.innerText=t.duration.toTime()}),t.addEventListener("timeupdate",()=>{const e=t.currentTime,o=t.duration;a.innerText=e.toTime(),s.style.setProperty("--progress",100*e/o)}),t.addEventListener("ended",()=>{e.classList.remove("play"),s.classList.remove("play"),a.innerText="00:00",s.style.setProperty("--progress",0),n.classList.remove("icon-pause")}),e.addEventListener("click",()=>{const o=e.classList.toggle("play");o?t.play():t.pause(),s.classList.toggle("play",o),n.classList.toggle("icon-pause",o)}),e.addEventListener("click",()=>{console.log("icon"),s.style.display="block"},{once:!0}),n.addEventListener("click",()=>{const o=e.classList.toggle("play");o?t.play():t.pause(),s.classList.toggle("play",o),n.classList.toggle("icon-pause",o)}),i.addEventListener("click",e=>{let{width:o}=getComputedStyle(i);o=parseFloat(o);const s=e.offsetX;t.currentTime=t.duration*s/o})});class pdfFrame extends HTMLElement{constructor(e){super(),this.id="pdf-overlay",this.className="overlay overlay-light-box icon-cancel";const t=document.createElement("iframe");t.id="pdf-iframe",t.setAttribute("frameBorder",0),t.src=e,this.append(t),this.addEventListener("click",()=>this.remove()),document.body.classList.add("pdf-frame-open"),document.body.append(this)}}customElements.define("pdf-frame",pdfFrame),customElements.define("pdf-preview",class extends HTMLImageElement{constructor(){super(),this.addEventListener("click",e=>{new pdfFrame(e.target.dataset.pdf)})}},{"extends":"img"}),document.getElementById("visitor-action-share-twitter").addEventListener("click",()=>{const e=encodeURIComponent("Check out this K-Poster\xae\n"),t=encodeURIComponent(event.twitter_hashtag.slice(1)),o=`https://twitter.com/intent/tweet?url=${location.href}&text=${e}&hashtags=${t}`,s=`resizable,scrollbars,status,height=350,width=500,left=${(window.innerWidth-500)/2},top=${(window.innerHeight-350)/2}`;window.open(o,"ShareOnTwitter",s).opener=null}),document.getElementById("visitor-action-share-ink").addEventListener("click",()=>{navigator.clipboard?navigator.clipboard.writeText(location.href).then(()=>{message("K-Poster's URL has been copied in your clipboard")})["catch"](()=>{prompt("Copy the K-Poster\xae URL above:",location.href)}):prompt("Copy the K-Poster\xae URL above:",location.href)});const contactAuthorForm=document.getElementById("contact-author-form");document.getElementById("visitor-action-contact-author").addEventListener("click",()=>{contactAuthorForm.classList.add("open")}),contactAuthorForm.addEventListener("submit",e=>{e.preventDefault();const t=new FormData(contactAuthorForm),o=contactAuthorForm.querySelectorAll("button");o.forEach(e=>e.disabled=!0),fetch(contactAuthorForm.action,{method:"POST",body:t}).then(e=>e.status).then(e=>{if(204!==e)throw" ";message("Your message has been sent to the author."),contactAuthorForm.reset()})["catch"](()=>{message("<b>Oops!</b><br>Something went wrong, we couldn't send your message.","error")})["finally"](()=>{o.forEach(e=>e.disabled=!1)})}),contactAuthorForm.addEventListener("reset",()=>{contactAuthorForm.classList.remove("open")});const shareMessageForm=document.getElementById("share-message-form");document.getElementById("visitor-action-share-message").addEventListener("click",()=>{shareMessageForm.classList.add("open")}),shareMessageForm.addEventListener("submit",e=>{e.preventDefault();const t=new FormData(shareMessageForm),o=shareMessageForm.querySelectorAll("button");o.forEach(e=>e.disabled=!0),fetch(shareMessageForm.action,{method:"POST",body:t}).then(e=>e.status).then(e=>{if(204!==e)throw"response not 204";message("The poster URL has been send"),shareMessageForm.reset(),shareMessageForm.classList.remove("open")})["catch"](e=>{console.log("error:",e),message("<b>Oops!</b><br>Something went wrong, we couldn't send the poster URL.","error",1e4)})["finally"](()=>{o.forEach(e=>e.disabled=!1)})}),shareMessageForm.addEventListener("reset",()=>{shareMessageForm.classList.remove("open")});const audio=document.getElementById("poster-narration-audio");if(audio){const e=document.getElementById("poster-narration-player"),t=document.getElementById("poster-narration-player-action"),o=document.getElementById("poster-narration-player-current"),s=document.getElementById("poster-narration-player-duration"),n=document.getElementById("poster-narration-player-progress"),a=document.getElementById("visitor-action-narration");function play_pause(){const o=a.classList.toggle("play");o?audio.play():audio.pause(),e.classList.toggle("play",o),t.classList.toggle("icon-pause",o)}audio.addEventListener("loadeddata",()=>{s.innerText=audio.duration.toTime()}),audio.addEventListener("timeupdate",()=>{const t=audio.currentTime,n=audio.duration;"--:--"===s.innerText&&(s.innerText=audio.duration.toTime()),o.innerText=t.toTime(),e.style.setProperty("--progress",100*t/n)}),audio.addEventListener("ended",()=>{e.classList.remove("play"),o.innerText="00:00",e.style.setProperty("--progress",0),t.classList.remove("icon-pause")}),a.addEventListener("click",()=>{const t=e.classList.toggle("visible"),o=a.classList.contains("play");(t||!t&&o)&&play_pause()}),t.addEventListener("click",play_pause),n.addEventListener("click",e=>{let{width:t}=getComputedStyle(n);t=parseFloat(t);const o=e.offsetX;audio.currentTime=audio.duration*o/t})}